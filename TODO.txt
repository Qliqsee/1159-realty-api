KYC MANAGEMENT AND APPROVAL TODO

COMPLETED
Schema migration added draft fields feedback lastSubmittedAt
All DTOs created for requests and responses
Service methods updated with draft management continueToNext support
All endpoints updated with proper response DTOs
GET kyc validate endpoint added
List endpoint with search and filters implemented
Approve and Reject endpoints accept feedback
Draft changes comparison implemented
isKycComplete and isKycVerified helper methods added

PENDING TASKS

KYC PERMISSIONS AND RBAC
Create permission kyc view own for clients to view their own KYC
Create permission kyc manage for clients to create update submit their KYC
Create permission kyc view all for admins to list and view all KYCs
Create permission kyc review for admins to approve or reject KYCs
Seed all KYC permissions in database via migration or seed script
Apply Permissions decorator with kyc view all to GET kyc list endpoint
Apply Permissions decorator with kyc view all to GET kyc id endpoint
Apply Permissions decorator with kyc review to PATCH kyc id approve endpoint
Apply Permissions decorator with kyc review to PATCH kyc id reject endpoint
Apply Permissions decorator with kyc view all to GET kyc id history endpoint
Apply Permissions decorator with kyc view own to GET kyc me endpoint
Apply Permissions decorator with kyc manage to all save step POST endpoints
Apply Permissions decorator with kyc manage to POST kyc submit endpoint
Test all permission guards work correctly for admin vs client access

KYC RESTRICTIONS AND VALIDATIONS
Create KycCompletionGuard to check if user has completed and verified KYC
Apply KycCompletionGuard to property endpoints that require verified KYC per PRD
Apply KycCompletionGuard to partnership application endpoint
Update guards to throw proper error messages indicating KYC completion required

KYC NOTIFICATIONS
Create email template for KYC submission notification to admin
Create email template for KYC approval notification to client
Create email template for KYC rejection notification to client with reason
Implement sendKycSubmittedEmail to notify admin when client submits KYC
Implement sendKycApprovedEmail to notify client when KYC is approved
Implement sendKycRejectedEmail to notify client when KYC is rejected with reason
Integrate email sending into submitKyc approveKyc rejectKyc service methods

TESTING AND VALIDATION
Test client KYC flow save each step see draft save and skip vs save and continue submit view status view draft changes
Test admin approval flow list KYCs with filters and search view details approve with feedback reject with reason
Test RBAC all endpoints ensure admins can access admin endpoints clients cannot
Test clients can only access their own KYC not others
Test KYC restrictions incomplete KYC users cannot access restricted property features
Test partnership application blocked for users without verified KYC
Test email notifications sent correctly for submission approval rejection
Test draft management save steps navigate between steps see unsaved changes compared to last submission
Test validation endpoint returns detailed field level errors before submission
Test pagination on list endpoint with different page sizes
Test search on list endpoint by client name email
Test filters by status and date ranges on list endpoint
